# üîã Lumion Analytics - Sistema de An√°lise de Consumo Energ√©tico (CDS)

## üìù Sum√°rio

  - [üëÄ Vis√£o Geral](#-vis√£o-geral)

  - [üèó Arquitetura](#-arquitetura)

  - [üìÅ Estrutura do Projeto](#-estrutura-do-projeto)

  - [‚öôÔ∏è Configura√ß√£o](#Ô∏è-configura√ß√£o)
    - [Pr√©-requisitos](#pr√©-requisitos)
    - [Instala√ß√£o](#instala√ß√£o)

  - [üöÄ Execu√ß√£o](#-execu√ß√£o)

  - [üìä Pipeline de Dados](#-pipeline-de-dados)
    - [Coleta (ANEEL)](#coleta-aneel)
    - [Processamento](#processamento)
    - [Armazenamento](#armazenamento)

  - [üîó Integra√ß√£o](#-integra√ß√£o)
    - [Com AICSS](#com-aicss)
    - [Com SCR](#com-scr)

  - [üìà M√©tricas e KPIs](#-m√©tricas-e-kpis)

  - [üîí Seguran√ßa](#-seguran√ßa)

  - [üìö Documenta√ß√£o API](#-documenta√ß√£o-api)

  - [üîÑ Manuten√ß√£o](#-manuten√ß√£o)

  - [üì± Interface Web](#-interface-web)

  - [üåê Endpoints API](#-endpoints-api)
    - [Dados ANEEL](#dados-aneel)
    - [An√°lise](#an√°lise)
    - [Integra√ß√£o AICSS](#integra√ß√£o-aicss)

  - [üìä Visualiza√ß√£o](#-visualiza√ß√£o)
    - [Dashboards](#dashboards)
    - [Relat√≥rios](#relat√≥rios)

  - [üîó Links √öteis](#-links-√∫teis)

  - [ü§ù Contribui√ß√£o](#-contribui√ß√£o)

  - [üìÑ Licen√ßa](#-licen√ßa)

## üëÄ Vis√£o Geral
Lumion Analytics √© um sistema de an√°lise de consumo energ√©tico que integra dados da Agencia Nacional de Energia El√©trica - ANEEL com informa√ß√µes do sistema AICSS que √© um sistema automatizado de controle de ilumina√ß√£o residencial que otimiza o consumo de energia atrav√©s de sensores e automa√ß√£o inteligente. O sistema gerencia tanto a ilumina√ß√£o interna quanto externa, considerando fatores como luminosidade ambiente e presen√ßa de pessoas. Essa integra√ß√£o tem como objetivo fornecer insights sobre padr√µes de consumo e efici√™ncia energ√©tica.

## üèó Arquitetura

 ```mermaid
graph TD
    A(ANEEL API) --> ETL
    B(AICSS Data) --> ETL
    C(Sensor Data) --> ETL
  
    ETL --> D{PostgreSQL DB}
    D --> E(Analytics Layer)
    E --> F(Visualiza√ß√£o)
    E --> G(Predi√ß√µes)
```

## üìÅ Estrutura do Projeto

* **cds/**: Diret√≥rio raiz do projeto.
    * **docker/**: Cont√©m os arquivos de configura√ß√£o e Dockerfiles para a cria√ß√£o dos containers.
    * **scripts/**: Scripts Python utilizados para o processo de ETL (Extract, Transform, Load).
        * **crawler.py:** Coleta dados da ANEEL.
        * **etl.py:** Realiza o processamento dos dados.
        * **pipeline.py:** Orquestra todo o processo de ETL.
    * **sql/**: Cont√©m os scripts SQL para cria√ß√£o das tabelas e execu√ß√£o das consultas.
        * **schema.sql:** Define o esquema do banco de dados.
        * **queries/**: Cont√©m as consultas SQL utilizadas no processo.
    * **data/**: Armazena os dados brutos e processados.
    * **README.md:** Este arquivo.

## ‚öôÔ∏è Configura√ß√£o

### Pr√©-requisitos
- Docker e Docker Compose
- Python 3.8+
- PostgreSQL 13+
- pip (Python package manager)

### Instala√ß√£o
1. Clone o reposit√≥rio:

```bash
git clone <repository-url>
cd cds
```
2. Configure o ambiente:

```python -m venv venv
source venv/bin/activate  # Linux/Mac
```
```
.\venv\Scripts\activate   # Windows
```
```
pip install -r requirements.txt
```

3. Configure as vari√°veis de ambiente:

```cp .env.example .env
# Edite .env com suas credenciais
```

## üöÄ Execu√ß√£o

1. Inicie os containers:

```
docker-compose up -d
```

2. Execute o pipeline:

```
python scripts/pipeline.py
```

## üìä Pipeline de Dados

### Coleta (ANEEL)
O processo come√ßa com a extra√ß√£o de dados diretamente da API da ANEEL, que permite o acesso a informa√ß√µes oficiais de maneira automatizada. Essa extra√ß√£o ocorre diariamente para assegurar que o banco de dados esteja sempre atualizado. Os dados s√£o recebidos no formato JSON/CSV.
- API REST para dados oficiais
- Periodicidade: Di√°ria
- Formato: JSON/CSV

### Processamento
Na etapa de processamento os dados passam pelas etapas listadas abaixo, para assegurar a qualidade e utilidade:

- Limpeza: S√£o eliminados dados duplicados, inconsistentes ou inv√°lidos, garantindo a integridade dos dados que ser√£o armazenados.
- Valida√ß√£o: Os dados s√£o checados para confirmar que atendem aos padr√µes esperados. Por exemplo, as datas devem estar em um formato correto, e os valores num√©ricos devem estar dentro de um intervalo aceit√°vel.
- Transforma√ß√£o de formatos: Os dados podem ser convertidos para um formato mais adequado para armazenamento ou an√°lise. Isso pode incluir a convers√£o de tipos de dados, o c√°lculo de novos valores ou a agrega√ß√£o de informa√ß√µes.
- Enriquecimento: Os dados coletados s√£o complementados com informa√ß√µes adicionais do AICSS, proporcionando uma vis√£o mais ampla e contextualizada, (refer√™ncia em `aicss/readme.md`, linhas 447-450).


### Armazenamento
Os dados processados s√£o armazenados em um banco de dados PostgreSQL, escolhemos esse SGBD, pois apresenta alta performance, escalabilidade e flexibilidade. Para otimizar o armazenamento e as consultas, s√£o utilizadas as seguintes t√©cnicas:

- Particionamento: As tabelas s√£o divididas em partes menores (parti√ß√µes), melhorando o desempenho de consultas em grandes volumes de dados.
- √çndices: foram criados √≠ndices em colunas para acelerar a busca por registros espec√≠ficos.
- Backup Autom√°tico: O banco de dados √© respaldado regularmente para garantir a recupera√ß√£o dos dados em caso de falhas ou perdas acidentais.

```mermaid
flowchart LR
    subgraph Coleta de Dados
        A((API ANEEL)) --> B((Coleta Di√°ria))
    end

    subgraph Processamento
        B --> C((Limpeza e Valida√ß√£o))
        C --> D((Transforma√ß√£o))
        D --> E((Enriquecimento com AICSS))
    end

    subgraph Armazenamento
        E --> F((PostgreSQL))
        F --> G((Particionamento))
        F --> H((Indexa√ß√£o))
        F --> I((Backup Autom√°tico))
    end
```

## üîó Integra√ß√£o

Com AICSS - Sistema automatizado de controle de ilumina√ß√£o residencial que otimiza o consumo de energia atrav√©s de sensores e automa√ß√£o inteligente. O sistema gerencia tanto a ilumina√ß√£o interna quanto externa, considerando fatores como luminosidade ambiente e presen√ßa de pessoas.
- Dados de sensores (refer√™ncia em `aicss/src/main.cpp`, linhas 5-10)
- M√©tricas de consumo
- Alertas em tempo real

Com SCR - Realiza an√°lise completa de dados de gera√ß√£o de energia distribu√≠da, utilizando dados da Ag√™ncia Nacional de Energia El√©trica - ANEEL, o c√≥digo automatiza o download, processamento e an√°lise de dados, gerando resultados estat√≠sticos, gr√°ficos e relat√≥rios completos, facilitando a compreens√£o da gera√ß√£o de energia distribu√≠da no Brasil.
- Exporta√ß√£o para an√°lise R (refer√™ncia em `aicss/readme.md`, linhas 457-460)
- Importa√ß√£o de predi√ß√µes
- M√©tricas de desempenho

## üìà M√©tricas e KPIs
M√©tricas e KPIs s√£o indicadores essenciais que nos ajudam a medir o desempenho e a efic√°cia de um sistema. No contexto de um sistema de an√°lise de dados, como o Lumion Analytics, essas m√©tricas s√£o fundamentais para assegurar a qualidade dos resultados e otimizar os processos. A seguir, vamos detalhar cada uma das m√©tricas mencionadas:

- Tempo de processamento ETL (Extract, Transform, Load): Essa m√©trica √© importante porque um tempo de processamento reduzido assegura que o data warehouse seja atualizado rapidamente, o que permite an√°lises mais √°geis e decis√µes baseadas em dados mais recentes. Para melhorar essa m√©trica, √© poss√≠vel otimizar as consultas SQL, utilizar ferramentas de ETL mais eficientes, aplicar paralelismo e realizar indexa√ß√£o.

- Lat√™ncia de queries: O ideial √© que essa m√©trica esteja sempre baixa, pois uma baixa lat√™ncia permite que os usu√°rios obtenham respostas r√°pidas √†s suas perguntas, o que facilita a tomada de decis√µes. Para melhorar essa m√©trica, √© poss√≠vel criar √≠ndices adequados, otimizar as consultas SQL, utilizar cache e investir em hardware mais potente.

- Taxa de sucesso de coleta: Essa m√©trica deve estar sempre alta, porque uma alta taxa de sucesso assegura a integridade dos dados e a confiabilidade das an√°lises. Para melhorar essa m√©trica, √© necess√°rio monitorar as fontes de dados, implementar mecanismos de repeti√ß√£o e alertas para falhas, al√©m de utilizar ferramentas de monitoramento robustas.

- Qualidade dos dados: Essa m√©trica mede a precis√£o, completude, consist√™ncia e relev√¢ncia dos dados, ela √© importante porque dados de alta qualidade s√£o essenciais para gerar insights confi√°veis e tomar decis√µes assertivas. Para melhorar essa m√©trica, √© fundamental implementar processos de limpeza e valida√ß√£o de dados, realizar an√°lises explorat√≥rias de dados e utilizar ferramentas de profiling de dados.

## üîí Seguran√ßa
- Autentica√ß√£o JWT: A assinatura digital assegura a integridade do token e previne qualquer manipula√ß√£o. O servidor n√£o precisa manter informa√ß√µes de sess√£o, o que torna o sistema mais escal√°vel e seguro. E pode ser utilizado em uma variedade de aplica√ß√µes e plataformas.

- SSL/TLS (Secure Sockets Layer/Transport Layer Security): Benef√≠cios confidencialidade, integridade e autenticidade

- Backup Autom√°tico: Benef√≠cios recupera√ß√£o de dados, conformidade e tranquilidade

- Logs de auditoria: Benef√≠cios investiga√ß√£o de incidentes, an√°lise de comportamento e conformidade

## üìö Documenta√ß√£o API
Dispon√≠vel em: `/docs/api.md`

## üîÑ Manuten√ß√£o
- Backup di√°rio automatizado
- Monitoramento 24/7
- Alertas em tempo real
- Logs detalhados

## üì± Interface Web
- Dashboard em tempo real
- Gr√°ficos interativos
- Relat√≥rios customizados
- Controle de acesso

## üåê Endpoints API

### Dados ANEEL

``` http
GET /api/v1/aneel/consumo
GET /api/v1/aneel/tarifas
POST /api/v1/aneel/sync
```

### An√°lise

``` http
GET /api/v1/analytics/consumo
GET /api/v1/analytics/previsao
GET /api/v1/analytics/relatorios
```
### Integra√ß√£o AICSS

``` http
POST /api/v1/aicss/dados
GET /api/v1/aicss/status
PUT /api/v1/aicss/config
```

## üìä Visualiza√ß√£o

### Dashboards
- Consumo em tempo real
- Hist√≥rico por per√≠odo
- Previs√µes futuras
- Alertas e notifica√ß√µes

### Relat√≥rios
- Di√°rios
- Semanais
- Mensais
- Personalizados

## üîó Links √öteis
- [Documenta√ß√£o API](/docs/api.md)
- [Guia de Contribui√ß√£o](/CONTRIBUTING.md)
- [Changelog](/CHANGELOG.md)

## ü§ù Contribui√ß√£o
1. Fork o projeto
2. Crie sua branch (`git checkout -b feature/AmazingFeature`)
3. Commit suas mudan√ßas (`git commit -m 'Add some AmazingFeature'`)
4. Push para a branch (`git push origin feature/AmazingFeature`)
5. Abra um Pull Request

## üìÑ Licen√ßa
Distribu√≠do sob a licen√ßa MIT. Veja `LICENSE` para mais informa√ß√µes.
